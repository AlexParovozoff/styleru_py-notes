# Лекция восьмая
Все слайды [тут](http://melevir.com/static/styleru_py/slides/8.html).

### БД
[Слайд 3](http://melevir.com/static/styleru_py/slides/8.html?full#3):
- SQL — язык запросов многих популярных БД. Его надо знать.

[Слайд 4](http://melevir.com/static/styleru_py/slides/8.html?full#4):
- Таблицы достаточно привести к третьей нормальной форме. (Это, по сути, означает, что база не должна хранить лишних данных).
- Если в таблице есть внешний ключ, то надо явно указать, что это внешний ключ. В более общем случае, базе данных нужно дать как можно больше информации о хранимых данных. Так она сможет оптимизировать свою работу.
- Индексы сильно ускоряют работу БД. Часто без них сайт нормально не заработает. Возьмем, например, блог с большим количеством постов. Чтобы выдать последние посты на главной, нужно их выбрать из БД по времени публикации. В этом случае колонку «Время публикации» нужно проиндексировать.
- В случае с индексацией, за скорость приходится платить местом на диске. Поэтому лишних индексов хранить не надо.
- Чтобы избежать багов, уникальные элементы должны быть помечены уникальными в базе.
- Бекапы помогут сохранить работу.

[Слайд 13-14](http://melevir.com/static/styleru_py/slides/8.html?full#13):
- SQL-инъекции не нужно фильтровать вручную. Стандартные средства справляются с этим куда лучше.

[Слайд 15-16](http://melevir.com/static/styleru_py/slides/8.html?full#15):
- Работать с БД напрямую с помощью SQL неудобно: трудно добавлять требования, менять их местами.

[Слайд 17-19](http://melevir.com/static/styleru_py/slides/8.html?full#17):
- Вместо чистого SQL лучше использовать ORM. Они знают, как безопасно (без SQL-инъекций) и эффективно сделать запрос в базу данных. При этом они повышают поддерживаемость кода.

[Слайд 20](http://melevir.com/static/styleru_py/slides/8.html?full#20):
- Пример запроса к БД серез ORM в обычном рабочем проекте.

[Слайд 21](http://melevir.com/static/styleru_py/slides/8.html?full#21):
- Некоторые не пользуются ORM.
- В Django есть встроенное ORM. Оно дает удобно составлять несложные запросы.
- Для чего-то более сложного используют SQLAlchemy.

### MVC
[Слайд 22-23](http://melevir.com/static/styleru_py/slides/8.html?full#22):
- Та часть приложения, которая отвечает за логику (структуры данных, алгоритмы и т.д.), называется моделью.

[Слайд 24](http://melevir.com/static/styleru_py/slides/8.html?full#24):
- Та часть приложения, которая не зависит от логики и отвечает за внешний вид данных, называется представлением. О ней можно думать как о шаблоне.

[Слайд 30](http://melevir.com/static/styleru_py/slides/8.html?full#30):
- В модели должно быть много кода.
- В контроллерах — не очень.
- В представление тем более не должно обрабатывать данные.

### исключения
[Слайд 31](http://melevir.com/static/styleru_py/slides/8.html?full#31):
- Исключения — это такая фича языка, которая позволяет обрабатывать исключительные ситуации. Например, ситуация, когда мы пытаемся преобразовать «авбыф» в число — исключительная.

[Слайд 35](http://melevir.com/static/styleru_py/slides/8.html?full#35):
- Если строку не получается преобразовать в число, выбрасывается исключение с информацией об ошибке.

[Слайд 36](http://melevir.com/static/styleru_py/slides/8.html?full#36):
- Стандартных исключений много.
- Они объединены в иерархию. Если мы будем ловить, например, `StandardError`, мы автоматически поймаем и `ValueError`, и `BufferError`, и много других. Так теряется информация о проблеме, поэтому если и ловить исключение, то максимально конкретное.
- Их можно наследовать, чтобы создать свои, но часто это не нужно.

[Слайд 37](http://melevir.com/static/styleru_py/slides/8.html?full#37):
- Вот так ловится исключение из нашего примера.

[Слайд 38](http://melevir.com/static/styleru_py/slides/8.html?full#38):
- Ловят исключения с помощью слова `catch`, бросают — с помощью `raise`.
- В нашем примере мы могли бы не ловить исключение. Вместо этого, мы бы проверили тип введенных данных с помощью метода `str.isnumeric` перед тем, как преобразовывать строку в число. Так было бы лучше с точки зрения поддерживаемости кода.
